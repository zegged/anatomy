<!-- 1b056539-d9d1-4652-8536-8fdb07530574 7b8c9c49-54db-47b8-92d8-ee1ea63c3209 -->
# Auto-Fetch Cranial Nerves and Keyboard Toggles (No UI)

### Scope

- Programmatically try direct GLB links for cranial nerves on the caskanatomy mirror, bypassing their viewer.
- Generate `public/models/nerves/manifest.json` with the subset of nerves actually available.
- Extend `public/index.html` to load base model plus available nerve GLBs into a `nerveGroup` with keyboard toggles for visibility and isolation.
- Add attribution logging and file for CC BY-SA items.

### Files to Add/Change

- `scripts/fetch_nerves.py` (new):
  - Attempts HEAD/GET for candidate GLB URLs per nerve slug
  - Downloads found GLBs into `public/models/nerves/<nerveId>.glb`
  - Writes `public/models/nerves/manifest.json` with: `{ id, name, url, localPath, license, credit }`
- `scripts/fetch_nerves.sh` (new): Thin wrapper to run Python with non-interactive defaults
- `public/models/nerves/ATTRIBUTION.txt` (new): consolidated attributions
- `public/index.html` (edit):
  - Load `./models/nerves/manifest.json` if present
  - For each entry, load with `GLTFLoader`, put under `nerveGroup`, initially hidden
  - Add keyboard toggles: digits 1–9/0 map to first 10 nerves; `a` show all, `h` hide all, `s` solo last toggled, `f` frame selection

### Candidate Sources (handled by script)

- Base URL pattern checked per nerve slug: `https://caskanatomy.info/open3dviewer/3dmodels/<slug>/<slug>.glb`
- Initial slug map (expandable):
  - CN I: `olfactory-nerve`
  - CN II: `optic-nerve`
  - CN III: `oculomotor-nerve`
  - CN IV: `trochlear-nerve`
  - CN V: `trigeminal-nerve`
  - CN VI: `abducens-nerve`
  - CN VII: `facial-nerve`
  - CN VIII: `vestibulocochlear-nerve`
  - CN IX: `glossopharyngeal-nerve`
  - CN X: `vagus-nerve`
  - CN XI: `accessory-nerve`
  - CN XII: `hypoglossal-nerve`
- Script HEAD-checks each; only downloads those resolving with 200.

### Loader Sketch (informative)

```html
<script type="module">
  // After base model load...
  const manifestUrl = './models/nerves/manifest.json';
  let nerveEntries = [];
  try { nerveEntries = await (await fetch(manifestUrl)).json(); } catch {}
  const nerveGroup = new THREE.Group(); scene.add(nerveGroup);
  const gltfLoader = new GLTFLoader();
  const idToNerve = new Map();
  for (const n of nerveEntries) {
    const gltf = await gltfLoader.loadAsync(n.localPath);
    const obj = gltf.scene; obj.visible = false; obj.userData = n; nerveGroup.add(obj);
    idToNerve.set(n.id, obj);
  }
  // Keyboard: 1–0, a/h/s/f ...
</script>
```

### Validation

- Run fetch script; confirm manifest contains available nerves
- Server renders skull plus togglable nerve objects
- Check frame/solo/show-all/hide-all keys
- Ensure attribution logged and file created

### Notes

- If no cranial nerve GLBs are found, the app still works; toggles just won’t show content
- We will not scrape Sketchfab; only direct GLB links are used
- Future: replace key toggles with a sidebar UI

### To-dos

- [ ] Add GLTFLoader import and GLB preference in public/index.html
- [ ] Implement GLB/GLTF → OBJ+MTL → OBJ → STL progressive loader
- [ ] Validate textured rendering using DamagedHelmet.glb
- [ ] Fetch AnatomyTool skull; use OBJ+MTL or convert OBJ→GLB
- [ ] Spot-check performance on a larger head/neck model
- [ ] Draft Phase 2 nerve visualization approach/design doc